<svg width="1260" height="950" xmlns="http://www.w3.org/2000/svg" font-family="Arial, sans-serif" viewBox="0 0 1260 950">

  <rect width="1260" height="950" fill="#ffffff" />

  <defs>
    <marker id="arrow-main" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto" fill="#2563EB">
      <polygon points="0 0, 10 3.5, 0 7" />
    </marker>
    <marker id="arrow-highlight" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto" fill="#FACC15">
      <polygon points="0 0, 10 3.5, 0 7" />
    </marker>
  </defs>

  <style>
    .main-title-text { font-size: 22px; font-weight: 800; fill: #111827; text-anchor: middle; }
    .title-text { font-size: 16px; font-weight: bold; fill: #111827; }
    .body-text { font-size: 12px; font-weight: normal; fill: #374151; }
    .small-text { font-size: 11px; font-weight: normal; fill: #6B7280; }
    .license-text { font-size: 12px; font-weight: normal; fill: #64748B; text-anchor: middle; }

    /* 规范 Sec 3: 元素样式 */
    .card-background { fill: #DBEAFE; stroke: #3B82F6; stroke-width: 2; rx: 15; }
    .card-note { fill: #EFF6FF; stroke: #60A5FA; stroke-width: 1; rx: 10; }
    .card-highlight { fill: #FEF9C3; stroke: #FACC15; stroke-width: 2; rx: 10; }

    /* 分支与提交 */
    .line-main { stroke: #60A5FA; stroke-width: 3; fill: none; }
    .commit-main { fill: #EFF6FF; stroke: #60A5FA; stroke-width: 2; }
    .label-main { fill: #60A5FA; }

    .line-feature { stroke: #34D399; stroke-width: 2; fill: none; }
    .commit-feature { fill: #F0FDF4; stroke: #34D399; stroke-width: 2; }
    .label-feature { fill: #34D399; }

    .label-head { fill: #FACC15; }

    .connector { stroke: #2563EB; stroke-width: 2; fill: none; marker-end: url(#arrow-main); }
  </style>

  <text x="600" y="40" class="main-title-text">Git Rebase(变基)策略</text>

  <g id="main-card" transform="translate(50, 80)">
    <rect class="card-background" width="1200" height="800" />

    <g id="rebase-before" transform="translate(50, 50)">
      <text x="0" y="0" class="title-text">1. Rebase 前 (Before)</text>
      <text x="0" y="25" class="body-text">
        执行: <tspan font-family="monospace">git checkout feature</tspan>
      </text>
      <text x="0" y="45" class="small-text">
        ( `feature` 分支基于 C2, 但 `master` 已经前进到 C4 )
      </text>

      <g transform="translate(100, 100)">
        <circle cx="100" cy="50" r="15" class="commit-main" />
        <text x="93" y="55" class="small-text">C1</text>
        <circle cx="200" cy="50" r="15" class="commit-main" />
        <text x="193" y="55" class="small-text">C2</text>
        <circle cx="300" cy="50" r="15" class="commit-main" />
        <text x="293" y="55" class="small-text">C3</text>
        <circle cx="400" cy="50" r="15" class="commit-main" />
        <text x="393" y="55" class="small-text">C4</text>

        <path d="M 115 50 L 385 50" class="line-main" />

        <circle cx="300" cy="120" r="15" class="commit-feature" />
        <text x="293" y="125" class="small-text">F1</text>
        <circle cx="400" cy="120" r="15" class="commit-feature" />
        <text x="393" y="125" class="small-text">F2</text>

        <path d="M 215 58 L 285 112" class="line-feature" />
        <path d="M 315 120 L 385 120" class="line-feature" />

        <rect x="370" y="0" width="60" height="20" rx="3" class="label-main" />
        <text x="378" y="15" font-size="12" fill="white">master</text>

        <rect x="370" y="150" width="60" height="20" rx="3" class="label-feature" />
        <text x="378" y="165" font-size="12" fill="white">feature</text>

        <rect x="290" y="150" width="60" height="20" rx="3" class="label-head" />
        <text x="300" y="165" font-size="12" fill="#374151" font-weight="bold">HEAD</text>
        <path d="M 320 170 L 320 180 L 370 170" stroke="#FACC15" stroke-width="2" fill="none" marker-end="url(#arrow-highlight)" />
      </g>
    </g>

    <g transform="translate(550, 220)">
      <path d="M 0 0 L 0 50" class="connector" />
      <text x="-100" y="25" class="body-text" fill="#2563EB" font-weight="bold">
        执行命令: <tspan font-family="monospace">git rebase master</tspan>
      </text>
    </g>

    <g id="rebase-after" transform="translate(50, 310)">
      <text x="0" y="0" class="title-text">2. Rebase 后 (After)</text>
      <text x="0" y="25" class="body-text">
        `feature` 分支的提交 (F1, F2) 被 "重放(replayed)" 到了 `master` 的顶端 (C4)。
      </text>
      <text x="0" y="45" class="small-text">
        注意： <tspan font-weight="bold" fill="#34D399">F1'</tspan> 和 <tspan font-weight="bold" fill="#34D399">F2'</tspan> 是全新的提交 (拥有新的SHA-1值)。
      </text>

      <g transform="translate(100, 100)">
        <circle cx="100" cy="50" r="15" class="commit-main" />
        <text x="93" y="55" class="small-text">C1</text>
        <circle cx="200" cy="50" r="15" class="commit-main" />
        <text x="193" y="55" class="small-text">C2</text>
        <circle cx="300" cy="50" r="15" class="commit-main" />
        <text x="293" y="55" class="small-text">C3</text>
        <circle cx="400" cy="50" r="15" class="commit-main" />
        <text x="393" y="55" class="small-text">C4</text>

        <circle cx="500" cy="50" r="15" class="commit-feature" />
        <text x="493" y="55" class="small-text">F1'</text>
        <circle cx="600" cy="50" r="15" class="commit-feature" />
        <text x="593" y="55" class="small-text">F2'</text>

        <path d="M 115 50 L 385 50" class="line-main" />
        <path d="M 415 50 L 585 50" class="line-feature" />

        <rect x="370" y="0" width="60" height="20" rx="3" class="label-main" />
        <text x="378" y="15" font-size="12" fill="white">master</text>

        <rect x="570" y="80" width="60" height="20" rx="3" class="label-feature" />
        <text x="578" y="95" font-size="12" fill="white">feature</text>

        <rect x="490" y="80" width="60" height="20" rx="3" class="label-head" />
        <text x="500" y="95" font-size="12" fill="#374151" font-weight="bold">HEAD</text>
        <path d="M 520 80 L 520 70 L 570 70" stroke="#FACC15" stroke-width="2" fill="none" marker-end="url(#arrow-highlight)" />
      </g>
    </g>

    <g id="cautions" transform="translate(50, 520)">
      <text x="0" y="0" class="title-text">3. Rebase vs Merge 及注意事项</text>

      <rect class="card-note" x="0" y="30" width="530" height="100" />
      <text x="20" y="55" class="title-text" fill="#3B82F6">Rebase (变基)</text>
      <text x="20" y="80" class="body-text">优点：创建一条干净、线性的提交历史，没有多余的合并提交。</text>
      <text x="20" y="100" class="body-text">缺点：<tspan font-weight="bold" fill="#D92D20">重写(Re-writes)提交历史</tspan> (F1 变为 F1')。</text>

      <rect class="card-note" x="570" y="30" width="530" height="100" />
      <text x="590" y="55" class="title-text" fill="#3B82F6">Merge (合并)</text>
      <text x="590" y="80" class="body-text">优点：<tspan font-weight="bold">保留(Preserves)完整历史</tspan>，非破坏性操作。</text>
      <text x="590" y="100" class="body-text">缺点：产生额外的"合并提交"，使历史图谱变得复杂(非线性)。</text>

      <rect class="card-highlight" x="0" y="150" width="1100" height="100" />
      <text x="550" y="180" class="title-text" text-anchor="middle">Rebase 的黄金法则 (The Golden Rule)</text>

      <text x="550" y="210" class="body-text" text-anchor="middle" font-size="14px" font-weight="bold" fill="#D92D20">
        !!! 永远不要 Rebase 已经推送到远程/公共/共享的分支 !!!
      </text>
      <text x="550" y="230" class="body-text" text-anchor="middle">
        (例如: `master`, `develop`, 或其他团队成员正在使用的分支)
      </text>
    </g>

  </g>

  <text x="600" y="930" class="license-text">
    本作品采用CC-BY-SA 4.0国际许可协议进行许可，© 2025 Gitconomy Research社区
  </text>
</svg>
